---
title: "è‡ªä½œCLIã‚’ä½œæˆã™ã‚‹"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["npm"]
published: true
---

:::message
ã“ã‚Œã¯2019å¹´01æœˆ04æ—¥ã«Qiitaã§ä½œæˆã—ãŸè¨˜äº‹ã‚’ç§»è¡Œã—ãŸã‚‚ã®ã«ãªã‚Šã¾ã™ã€‚
:::

# å§‹ã‚ã«

webpackã¨ã‹ã€browser-syncã¨ã‹ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦cliã§å®Ÿè¡Œã—ã¦ã„ã¾ã™ãŒã€ãã‚Œã‚’è‡ªä½œã™ã‚‹å ´åˆã®è©±ã§ã™ã€‚
ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’require/importã™ã‚‹æ–¹æ³•ã¯ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚

https://zenn.dev/numa_san/articles/3de3a8996cd6eb

# npmãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä½œæˆ

CLIã§å®Ÿè¡Œã§ãã‚‹ã‚ˆã†ã«ä»¥ä¸‹ã®ã‚ˆã†ãªè¨­å®šã‚’ã—ã¾ã™ã€‚
é‡è¦ãªã¨ã“ã‚ã¯`bin`ã®ã¨ã“ã‚ã§ã™ã€‚
requireã‚„importã§ä½¿ã†è¨­å®šã¯`main`ã®ã¨ã“ã‚ã«æ›¸ããŸã‚ã€CLIã¨ä½µç”¨ã—ã¦å®šç¾©ã§ãã¾ã™ã€‚
ãƒ­ãƒ¼ã‚«ãƒ«ã§cliã®å‹•ä½œã‚’ç¢ºèªã™ã‚‹å ´åˆã¯nodeã§ç›´æ¥å®Ÿè¡Œã™ã‚Œã°ã„ã„ã®ã§`scripts`ã«å®šç¾©ã—ã¦ãŠãã¾ã™ã€‚

```json:package.json
{
  "name": "mylib",
  "version": "1.0.0",
  "description": "",
  //"main": "lib.js",  // requireã‚„importã§å‘¼ã°ã‚Œã‚‹ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã€‚cliã¨ã¯åˆ¥ã§å®šç¾©å¯èƒ½
  "private": true,
  // cliã®å®šç¾©
  "bin": {
    "mylib-cli": "cli.js"  // keyãŒã‚³ãƒãƒ³ãƒ‰åã§ã€valueãŒå®Ÿè¡Œã•ã‚Œã‚‹JSãƒ•ã‚¡ã‚¤ãƒ«ã«ãªã‚‹
  },
  "scripts": {
    "cli-test": "node cli.js --param hello"  // ãƒ­ãƒ¼ã‚«ãƒ«ã§è©¦ã™å ´åˆã¯ç›´æ¥JSã‚’å®Ÿè¡Œã™ã‚‹ï¼ˆå¼•æ•°ã‚‚æ¸¡ã›ã‚‹ï¼‰
  },
  "dependencies": {
    "commander": "^2.19.0",
    "lodash": "^4.17.11",
    "path": "^0.12.7"
  },
  "author": "",
  "license": "MIT"
}
```

CLIã®ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã«ã—ã¾ã—ãŸã€‚
1è¡Œç›®ã®`#!/usr/bin/env node`ã¯cliã§å®Ÿè¡Œã™ã‚‹ãŸã‚ã«ã¯å¿…é ˆã¨ãªã‚Šã¾ã™ã€‚
commanderã‚’ä½¿ç”¨ã™ã‚‹ã¨å¼•æ•°ã®å–å¾—ãŒæ¥½ã«ãªã‚‹ã®ã§ä½¿ã£ã¦ã„ã¾ã™ã€‚

```js:cli.js
#!/usr/bin/env node

const program = require('commander');

program
  .option('-p, --param <value>', 'Add params')
  .parse(process.argv);

console.log('receive param: %s', program.param);
```

# å‹•ä½œç¢ºèª

scriptsã«å®šç¾©ã—ã¦ã„ãŸã®ã§ã€ä»¥ä¸‹ã§å‹•ä½œç¢ºèªã‚’ã—ã¾ã™ã€‚

```bash
$ yarn run cli-test
receive param: hello
```

ã¾ãŸã¯nodeã§ç›´æ¥å®Ÿè¡Œã—ã¾ã™ã€‚

```bash
$ node cli.js --param test
receive param: test
```

# packageã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä½¿ã†

ä½œæˆã—ãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã«é…ç½®ã—ã¦ã„ã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
https://github.com/TakanoriOnuma/test-library

```bash
$ yarn add TakanoriOnuma/test-library
```

scriptsã«ä»¥ä¸‹ã®ã‚ˆã†ãªã‚‚ã®ã‚’å®šç¾©ã—ã¦å®Ÿè¡Œã™ã‚Œã°cliãŒå‹•ä½œã—ã¾ã™ã€‚

```json
{
  "scripts": {
    "cli": "mylib-cli --param use-cli"
  }
}
```

```bash
$ yarn run cli
receive param: use-cli
```

ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®ãƒªãƒã‚¸ãƒˆãƒªã«ç½®ã„ã¦ã„ã¾ã™ã€‚
https://github.com/TakanoriOnuma/test-use-library

## è£œè¶³

ãƒ­ãƒ¼ã‚«ãƒ«ã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒã‚‚ã©ã‹ã—ã„å ´åˆã¯ã€`npm link`ã‚’ä½¿ã†ã¨ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—è©¦ã—ãŸå¾Œå‰Šé™¤ã™ã‚‹å ´åˆã¯`npm unlink`ã‚’ã™ã‚‹ã®ã§ã™ãŒã€åƒ•ã®å ´åˆã¯ä¸Šæ‰‹ãå‰Šé™¤ã§ãã¾ã›ã‚“ã§ã—ãŸã€‚nodebrewã¨ã‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚’ä½¿ã£ã¦ã„ã‚‹ãŸã‚ã‹ã€ã‚ã‚‹ã„ã¯æ¨©é™ãŒã‚ˆããªã‹ã£ãŸã®ã‹åŸå› ã¯åˆ†ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸãŒã€`npm link`ã‚’ä½¿ã†å ´åˆã¯æ³¨æ„ã—ã¦ãã ã•ã„ã€‚

# å‚è€ƒURL

https://qiita.com/star__hoshi/items/51c6cc719793abfb337d
https://qiita.com/toshihirock/items/431530172b25352d045f
