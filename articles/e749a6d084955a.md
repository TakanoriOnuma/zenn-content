---
title: "ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’React hooksã§å®Ÿè£…ã™ã‚‹"
emoji: "ğŸŒŸ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react"]
published: false
---

## å§‹ã‚ã«

ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ä½¿ã†éš›ã«ã€`window.confirm`ã ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«returnã§true/falseã§è¿”ã£ã¦ãã‚‹ãŸã‚å‡¦ç†ã®æµã‚ŒãŒèª­ã¿ã‚„ã™ã„ã§ã™ã€‚

```tsx:window.confirmã‚’ä½¿ã£ãŸç¢ºèªãƒ­ã‚¸ãƒƒã‚¯
const Page: FC = () => {
  return (
    <Button
      variant="contained"
      onClick={() => {
        const result = window.confirm("æœ¬å½“ã«ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ");
        if (result === true) {
          enqueueSnackbar("å®Ÿè¡Œã—ã¾ã—ãŸ", {
            variant: "success"
          });
        }
      }}
    >
      ç¢ºèª
    </Button>
  )
}
```

ã—ã‹ã—è‡ªä½œã®ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ä½¿ã£ãŸå ´åˆã€ã‚ˆã`isOpen`ã®ã‚ˆã†ãªé–‹é–‰ãƒ•ãƒ©ã‚°ã‚’ç”¨æ„ã—ã¦è¡¨ç¤ºã™ã‚‹ã“ã¨ãŒå¤šãã€å‡¦ç†ã®æµã‚ŒãŒä¸€åº¦é€”åˆ‡ã‚Œã¦ã—ã¾ã„ã¾ã™ã€‚

```tsx:ã‚ˆãã‚„ã‚‹è‡ªä½œãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ä½¿ç”¨ä¾‹
const Page: FC = () => {
  const [isOpen, setIsOpen] = useState(false)

  return (
    <Box>
      <Button
        variant="contained"
        onClick={() => {
          setIsOpen(true);
          // ã“ã“ã§å‡¦ç†ãŒé€”åˆ‡ã‚Œã¦ã—ã¾ã†
        }}
      >
        ç¢ºèª
      </Button>
      <Dialog
        open={isOpen}
        onClose={() => {
          setIsOpen(false);
        }}
      >
        <DialogTitle>ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
        <DialogContent>æœ¬å½“ã«ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ</DialogContent>
        <DialogActions>
          <Button
            variant="outlined"
            onClick={() => {
              setIsOpen(false);
            }}
          >
            ã‚­ãƒ£ãƒ³ã‚»ãƒ«
          </Button>
          <Button
            variant="contained"
            onClick={() => {
              // ç¢ºèªãŒOKã ã£ãŸæ™‚ã®å‡¦ç†ãŒä»¥ä¸‹ã«ãªã‚‹ãŒã€UIã®ã‚³ãƒ¼ãƒ‰ã‚‚æ··ã–ã£ã¦ã„ã¦å‡¦ç†ã®æµã‚ŒãŒæ´ã¿ã¥ã‚‰ã„
              enqueueSnackbar("å®Ÿè¡Œã—ã¾ã—ãŸ", {
                variant: "success"
              });
              setIsOpen(false);
            }}
          >
            OK
          </Button>
        </DialogActions>
      </Dialog>
    </Box>
  )
}
```

ã“ã‚ŒãŒä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ç¢ºèªãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã—ãŸã‚‰è‡ªå‹•ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒé–‹ãã€ãã®çµæœãŒã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¨ã—ã¦å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‰å‡¦ç†ã®æµã‚ŒãŒåˆ†ã‹ã‚Šã‚„ã™ãã€ã‚¹ãƒƒã‚­ãƒªã—ãŸã‚³ãƒ¼ãƒ‰ã«ãªã‚‹ã®ã§ã¯æ€ã„ã€ãã‚Œã‚’ä½œã‚‹ã“ã¨ãŒã§ãã‚‹hooksã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã®ã§å‚™å¿˜éŒ²ã¨ã—ã¦ã¾ã¨ã‚ã¾ã—ãŸã€‚

```tsx:ã‚«ã‚¹ã‚¿ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã‚‚å®Ÿè¡Œæ™‚ã«ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã§å—ã‘å–ã‚Œã‚‹hooksã®ä½¿ç”¨ã‚¤ãƒ¡ãƒ¼ã‚¸
// å‘¼ã¶ã ã‘ã§ç›®çš„ã®ã‚«ã‚¹ã‚¿ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã§ãã‚‹hooks
const useSimpleCustomConfirm = () => {
  // ã‚«ã‚¹ã‚¿ãƒ UIã®å†…å®¹ã‚’å®šç¾©ã™ã‚‹æ±ç”¨çš„ãªhooksã‚’å‘¼ã‚“ã§ã€UIéƒ¨åˆ†ã ã‘å®šç¾©ã™ã‚‹
  return useCustomConfirm({
    renderContent: ({ ok, cancel }) => {
      return (
        <>
          <DialogTitle>ã‚·ãƒ³ãƒ—ãƒ«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
          <DialogContent>æœ¬å½“ã«ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿ</DialogContent>
          <DialogActions>
            <Button variant="outlined" onClick={cancel}>
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </Button>
            <Button variant="contained" onClick={ok}>
              OK
            </Button>
          </DialogActions>
        </>
      )
    }
  });
}

const Page: FC = () => {
  // ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‡ºã™ãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºç”¨ã®Reactè¦ç´ ã‚’è¿”ã™
  const { confirm, dialogElement } = useSimpleCustomConfirm();

  return (
    <Box>
      <Button
        variant="contained"
        onClick={() => {
          // ç¢ºèªãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè¡¨ç¤ºã•ã‚Œã¦ã€OKã§ã‚ã£ãŸå ´åˆã®å‡¦ç†ã‚’å¼•æ•°ã«ã‹ã‘ã‚‹
          confirm({
            onOk: () => {
              enqueueSnackbar("å®Ÿè¡Œã—ã¾ã—ãŸ", {
                variant: "success",
              });
            },
          });
        }}
      >
        ç¢ºèª
      </Button>
      {dialogElement}
    </Box>
  );
};
```

## ã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’React hooksã§å®Ÿè£…ã™ã‚‹æ–¹æ³•

ä¸Šã®ä¾‹ã§è¦‹ã›ãŸã‚ˆã†ãªã‚‚ã®ã‚’å®Ÿè£…ã—ã¦ã„ãã¾ã™ãŒã€æ›´ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ãéš›ã«è¿½åŠ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã›ãŸã‚Šã€éåŒæœŸå®Ÿè¡Œæ™‚ã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å‡ºã™ãªã©æ§˜ã€…ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã«ã‚‚å¯¾å¿œã§ãã‚‹ã‚ˆã†ã«æ‹¡å¼µã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚

### ã‚·ãƒ³ãƒ—ãƒ«ãªã‚«ã‚¹ã‚¿ãƒ UIã«å¯¾å¿œã§ãã‚‹hooksã‚’ä½œã‚‹

ã¾ãšã¯ä¸Šã®ä¾‹ã§è¦‹ã›ãŸã‚³ãƒ³ãƒ†ãƒ³ãƒ„éƒ¨åˆ†ã‚‚è‡ªç”±ã«å®šç¾©ã§ãã‚‹`useCustomConfirm`ã‚’ä½œã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã“ã¨ã§ä¸Šã®ä¾‹ã§è¦‹ã›ãŸã‚·ãƒ³ãƒ—ãƒ«ãªã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```tsx:ã‚·ãƒ³ãƒ—ãƒ«ãªã‚«ã‚¹ã‚¿ãƒ UIã«ã§ãã‚‹hooks
import { ReactElement, useState, useCallback } from "react";

import { Dialog } from "@mui/material";

export type UseCustomConfirmOption = {
  /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æç”»ã™ã‚‹ */
  renderContent: (props: {
    /** OKã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ */
    ok: () => void;
    /** ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ */
    cancel: () => void;
  }) => ReactElement;
};

/** ã‚¯ãƒªãƒƒã‚¯æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ */
type ActionHandler = () => void;

export type ReturnUseCustomConfirm = {
  /** ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‡ºã™ */
  confirm: (props: { onOk: ActionHandler }) => void;
  /** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¦ç´  */
  dialogElement: ReactElement;
};

/**
 * ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‘¼ã³å‡ºã™hooks
 */
export const useCustomConfirm = function ({
  renderContent,
}: UseCustomConfirmOption): ReturnUseCustomConfirm {
  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å†…ã§OKãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã«å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’stateã§æŒã¤
  const [execOk, setExecOk] = useState<ActionHandler | null>(null);

  const handleOk = useCallback(() => {
    if (execOk == null) {
      return;
    }
    execOk();
    setExecOk(null);
  }, [execOk]);

  const handleClose = useCallback(() => {
    setExecOk(null);
  }, []);

  const confirm: ReturnUseCustomConfirm["confirm"] = useCallback(
    ({ onOk }) => {
      setExecOk(() => onOk);
    },
    []
  );

  // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã«è¡¨ç¤ºã™ã‚‹ReactElementã‚’ç”Ÿæˆã™ã‚‹
  const dialogContentElement = renderContent({
    ok: handleOk,
    cancel: handleClose,
  });

  // OKæ™‚ã®å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã£ã¦ã„ã‚‹ã‹ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ãã‹åˆ¤æ–­ã™ã‚‹
  const isOpen = execOk != null;
  const dialogElement: ReturnUseCustomConfirm["dialogElement"] = (
    <Dialog open={isOpen} onClose={handleClose}>
      {dialogContentElement}
    </Dialog>
  );

  return {
    confirm,
    dialogElement,
  };
};
```

### è¿½åŠ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹

ä¸Šã®ã‚³ãƒ¼ãƒ‰ã ã‘ã§ã‚‚è‰²ã€…ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã‚‹ã¨æ€ã„ã¾ã™ãŒã€é–‹ãéš›ã«ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã›ã‚‹ã‚ˆã†ã«ãªã‚‹ã¨æ›´ã«è‡ªç”±åº¦ãŒä¸ŠãŒã‚‹ã¨æ€ã†ã®ã§ã€ãã‚ŒãŒã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```diff tsx:confirmå®Ÿè¡Œæ™‚ã«è¿½åŠ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã›ã‚‹ã‚ˆã†ã«ã™ã‚‹
 import { ReactElement, useState, useCallback } from "react";

 import { Dialog } from "@mui/material";

+/** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§è¿½åŠ ã™ã‚‹å‹ */
+type AdditionalContentProps<ContentProps = undefined> = [ContentProps] extends [
+  undefined
+]
+  ? {}
+  : {
+      props: ContentProps;
+    };

-export type UseCustomConfirmOption = {
+export type UseCustomConfirmOption<ContentProps = undefined> = {
   /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æç”»ã™ã‚‹ */
   renderContent: (props: {
+    /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«æ¸¡ã™props */
+    props?: ContentProps;
     /** OKã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ */
     ok: () => void;
     /** ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ */
     cancel: () => void;
   }) => ReactElement;
 };

 /** ã‚¯ãƒªãƒƒã‚¯æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ */
 type ActionHandler = () => void;

-export type ReturnUseCustomConfirm = {
+export type ReturnUseCustomConfirm<ContentProps = undefined> = {
   /** ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‡ºã™ */
   confirm: (
     props: {
      onOk: ActionHandler
+    } & AdditionalContentProps<ContentProps>
   ) => void;
   /** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¦ç´  */
   dialogElement: ReactElement;
 };

 /**
  * ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‘¼ã³å‡ºã™hooks
  */
-export const useCustomConfirm = function ({
+export const useCustomConfirm = function <ContentProps = undefined>({
   renderContent,
-}: UseCustomConfirmOption): ReturnUseCustomConfirm {
+}: UseCustomConfirmOption<ContentProps>): ReturnUseCustomConfirm<ContentProps> {
   // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å†…ã§OKãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã«å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’stateã§æŒã¤
   const [execOk, setExecOk] = useState<ActionHandler | null>(null);
+  // è¿½åŠ ã§æ¸¡ã™propsã‚’stateã§æŒã¤
+  const [contentProps, setContentProps] = useState<ContentProps>();

   const handleOk = useCallback(() => {
     if (execOk == null) {
       return;
     }
     execOk();
     setExecOk(null);
   }, [execOk]);

   const handleClose = useCallback(() => {
     setExecOk(null);
   }, []);

-  const confirm: ReturnUseCustomConfirm["confirm"] = useCallback(
-    ({ onOk }) => {
+  const confirm: ReturnUseCustomConfirm<ContentProps>["confirm"] = useCallback(
+    ({ onOk, ...restProps }) => {
+      if ("props" in restProps) {
+        setContentProps(restProps.props as ContentProps);
+      }
       setExecOk(() => onOk);
     },
     []
   );

   // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã«è¡¨ç¤ºã™ã‚‹ReactElementã‚’ç”Ÿæˆã™ã‚‹
   const dialogContentElement = renderContent({
+    props: contentProps,
     ok: handleOk,
     cancel: handleClose,
   });

   // OKæ™‚ã®å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã£ã¦ã„ã‚‹ã‹ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ãã‹åˆ¤æ–­ã™ã‚‹
   const isOpen = execOk != null;
   const dialogElement: ReturnUseCustomConfirm["dialogElement"] = (
     <Dialog open={isOpen} onClose={handleClose}>
       {dialogContentElement}
     </Dialog>
   );

   return {
     confirm,
     dialogElement,
   };
 };
```

ã“ã‚“ãªæ„Ÿã˜ã§å‘¼ã³å‡ºã™ã“ã¨ã§ã€å‹•çš„ã«å¤‰æ›´ã—ã¦ä½¿ãˆã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚é–‹ãå‰ã‹ã‚‰ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã—ãŸã„ã‚±ãƒ¼ã‚¹ã¯ãƒ©ãƒƒãƒ—ã—ãŸhooksã®å¼•æ•°å´ã§å—ã‘å–ã£ã¦ä½¿ç”¨ã™ã‚Œã°ã‚ˆãã€ãã®è¾ºã‚‚è‡ªç”±ã«æ±ºã‚ã‚‰ã‚Œã¾ã™ã€‚

```tsx:è¿½åŠ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™ä¾‹
const useVariableSimpleCustomConfirm = ({ title }: { title: string }) => {
  return useCustomConfirm<{ content: string }>({
    renderContent: ({ props, ok, cancel }) => {
      if (props == null) {
        return <></>;
      }
      return (
        <>
          <DialogTitle>{title}</DialogTitle>
          <DialogContent>{props.content}</DialogContent>
          <DialogActions>
            <Button variant="outlined" onClick={cancel}>
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </Button>
            <Button variant="contained" onClick={ok}>
              OK
            </Button>
          </DialogActions>
        </>
      );
    },
  });
};

const Page: FC = () => {
  const [contentText, setContentText] = useState("ãƒ†ã‚­ã‚¹ãƒˆ");
  const { confirm, dialogElement } = useVariableCustomConfirm({
    // hookså´ã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã“ã¨ã‚‚å¯èƒ½
    title: "ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å¤‰æ›´å¯èƒ½ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°",
  });

  return (
    <Box>
      <TextField
        value={contentText}
        label="ã‚³ãƒ³ãƒ†ãƒ³ãƒ„"
        size="small"
        onChange={(event) => {
          setContentText(event.target.value);
        }}
      />
      <br />
      <Button
        variant="contained"
        onClick={() => {
          confirm({
            // confirmå®Ÿè¡Œæ™‚ã«è¿½åŠ ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æ¸¡ã™
            props: {
              content: contentText,
            },
            onOk: () => {
              enqueueSnackbar("å®Ÿè¡Œã—ã¾ã—ãŸ", {
                variant: "success",
              });
            },
          });
        }}
      >
        ç¢ºèª
      </Button>
      {dialogElement}
    </Box>
  );
};
```

### éåŒæœŸå®Ÿè¡Œæ™‚ã«ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å‡ºã›ã‚‹ã‚ˆã†ã«ã™ã‚‹

ç¶šã„ã¦onOkæ™‚ã®å‡¦ç†ãŒéåŒæœŸã ã£ãŸå ´åˆã®å¯¾å¿œã‚‚ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚å®Ÿéš›ã®ã‚±ãƒ¼ã‚¹ã§ã¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§OKã ã£ãŸå ´åˆã«APIãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’æŠ•ã’ã¦ã€æˆåŠŸã—ãŸã‚‰ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹ã‚±ãƒ¼ã‚¹ãŒã‚ã‚‹ã¨æ€ã„ã¾ã™ãŒã€ç¾çŠ¶ã ã¨éåŒæœŸå‡¦ç†ãŒè€ƒæ…®ã•ã‚Œã¦ã„ãªã„ãŸã‚ã™ãé–‰ã˜ã¦ã—ã¾ã„ã¾ã™ã€‚éåŒæœŸå‡¦ç†ä¸­ã¯ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¡¨ç¤ºã«ã—ã¦ã€æˆåŠŸã—ãŸæ™‚ã«ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹ä½œã‚Šã«ã—ã¦ãŠãã¨æ¯å›ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è¨­å®šã‚‚æ›¸ãå¿…è¦ãŒãªããªã£ã¦ä¾¿åˆ©ãã†ã§ã™ã€‚

```diff tsx:éåŒæœŸå®Ÿè¡Œã‚’è€ƒæ…®ã—ãŸhooksã«ã™ã‚‹
 import { ReactElement, useState, useCallback } from "react";

 import { Dialog } from "@mui/material";

 /** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§è¿½åŠ ã™ã‚‹å‹ */
 type AdditionalContentProps<ContentProps = undefined> = [ContentProps] extends [
   undefined
 ]
   ? {}
   : {
       props: ContentProps;
     };

 export type UseCustomConfirmOption<ContentProps = undefined> = {
   /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æç”»ã™ã‚‹ */
   renderContent: (props: {
     /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«æ¸¡ã™props */
     props?: ContentProps;
+    /** å‡¦ç†ä¸­ã‹ */
+    processing: boolean
     /** OKã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ */
     ok: () => void;
     /** ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ */
     cancel: () => void;
   }) => ReactElement;
 };

 /** ã‚¯ãƒªãƒƒã‚¯æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ */
-type ActionHandler = () => void;
+type ActionHandler = () => void | Promise<void>;

 export type ReturnUseCustomConfirm<ContentProps = undefined> = {
   /** ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‡ºã™ */
   confirm: (
     props: {
      onOk: ActionHandler
     } & AdditionalContentProps<ContentProps>
   ) => void;
   /** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¦ç´  */
   dialogElement: ReactElement;
 };

 /**
  * ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã•ã‚ŒãŸç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‘¼ã³å‡ºã™hooks
  */
 export const useCustomConfirm = function <ContentProps = undefined>({
   renderContent,
 }: UseCustomConfirmOption<ContentProps>): ReturnUseCustomConfirm<ContentProps> {
+  // éåŒæœŸå‡¦ç†ä¸­ã‹ã‚’ç®¡ç†ã™ã‚‹ãƒ•ãƒ©ã‚°
+  const [isProcessing, setIsProcessing] = useState(false);
   // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å†…ã§OKãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ãŸã¨ãã«å®Ÿè¡Œã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’stateã§æŒã¤
   const [execOk, setExecOk] = useState<ActionHandler | null>(null);
   // è¿½åŠ ã§æ¸¡ã™propsã‚’stateã§æŒã¤
   const [contentProps, setContentProps] = useState<ContentProps>();

   const handleOk = useCallback(() => {
     if (execOk == null) {
       return;
     }
-    execOk();
-    setExecOk(null);

+    const result = execOk();
+    // OKæ™‚ã®å‡¦ç†ãŒPromiseã§ãªã„ã¨ãã¯å³é–‰ã˜ã‚‹
+    if (!(result instanceof Promise)) {
+      setExecOk(null);
+      return;
+    }

+    // OKæ™‚ã®å‡¦ç†ãŒPromiseã ã£ãŸå ´åˆã€å‡¦ç†ä¸­ã®ãƒ•ãƒ©ã‚°ã‚’ç«‹ã¦ã¦ã€resolveã—ãŸæ™‚ã«é–‰ã˜ã‚‹ã‚ˆã†ã«ã™ã‚‹
+    setIsProcessing(true);
+    result
+      .then(() => {
+        setExecOk(null);
+      })
+      .catch((err) => {
+        console.log("catch reject", err);
+      })
+      .finally(() => {
+        setIsProcessing(false);
+      });
   }, [execOk]);

   const handleClose = useCallback(() => {
+    // å‡¦ç†ä¸­ã®æ™‚ã¯é–‰ã˜ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹
+    if (isProcessing) {
+      return;
+    }
     setExecOk(null);
-   }, []);
+   }, [isProcessing]);

  const confirm: ReturnUseCustomConfirm<ContentProps>["confirm"] = useCallback(
     ({ onOk, ...restProps }) => {
       if ("props" in restProps) {
         setContentProps(restProps.props as ContentProps);
       }
       setExecOk(() => onOk);
     },
     []
   );

   // ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã«è¡¨ç¤ºã™ã‚‹ReactElementã‚’ç”Ÿæˆã™ã‚‹
   const dialogContentElement = renderContent({
     props: contentProps,
+    processing: isProcessing,
     ok: handleOk,
     cancel: handleClose,
   });

   // OKæ™‚ã®å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã£ã¦ã„ã‚‹ã‹ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ãã‹åˆ¤æ–­ã™ã‚‹
   const isOpen = execOk != null;
   const dialogElement: ReturnUseCustomConfirm["dialogElement"] = (
     <Dialog open={isOpen} onClose={handleClose}>
       {dialogContentElement}
     </Dialog>
   );

   return {
     confirm,
     dialogElement,
   };
 };
```

ã“ã‚“ãªæ„Ÿã˜ã§ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚æŠ˜è§’ãªã®ã§éåŒæœŸå®Ÿè¡Œã§æˆåŠŸ/å¤±æ•—ã‚’é¸æŠã§ããŸã‚Šã€é…å»¶å¾…ã¡æ™‚é–“ã‚’è¨­å®šã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```tsx:confirmã®onOkæ™‚ã«éåŒæœŸå®Ÿè¡Œã™ã‚‹ä¾‹
type AsyncExecType = "success" | "fail";
const useAsyncCustomConfirm = () => {
  return useCustomConfirm<{ asyncExecType: AsyncExecType; waitTime: number }>({
    renderContent: ({ props, processing, ok, cancel }) => {
      if (props == null) {
        return <></>;
      }
      const asyncExecTypeLabel =
        props.asyncExecType === "success" ? "æˆåŠŸ" : "å¤±æ•—";
      return (
        <>
          <DialogTitle>éåŒæœŸå®Ÿè¡Œã‚’å¾…ã¤ãƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
          <DialogContent>
            <Box>éåŒæœŸå®Ÿè¡Œç¨®åˆ¥: {asyncExecTypeLabel}</Box>
            <Box>é…å»¶æ™‚é–“: {props.waitTime}ms</Box>
          </DialogContent>
          <DialogActions>
            <LoadingButton
              // å‡¦ç†ä¸­ã¯processingãŒtrueã«ãªã‚‹ãŸã‚ã€ã“ã‚Œã§ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®è¡¨ç¤ºãŒã§ãã‚‹
              loading={processing}
              variant="outlined"
              onClick={cancel}
            >
              ã‚­ãƒ£ãƒ³ã‚»ãƒ«
            </LoadingButton>
            <LoadingButton
              loading={processing}
              variant="contained"
              onClick={ok}
            >
              OK
            </LoadingButton>
          </DialogActions>
        </>
      );
    },
  });
};

const Page: FC = () => {
  const [waitTime, setWaitTime] = useState(1000);
  const [asyncExecType, setAsyncExecType] = useState<AsyncExecType>("success");
  const { confirm, dialogElement } = useAsyncCustomConfirm();

  return (
    <Box>
      {/* waitTime, asyncExecTypeã®è¨­å®šéƒ¨åˆ†ã¯æœ¬è³ªçš„ãªéƒ¨åˆ†ã§ã¯ãªã„ã®ã§å‰²æ„› */}
      <br />
      <Button
        variant="contained"
        onClick={() => {
          confirm({
            props: {
              asyncExecType,
              waitTime,
            },
            onOk: () => {
              // Promiseã‚’è¿”ã™ã“ã¨ã§è§£æ±ºã™ã‚‹ã¾ã§processingãƒ•ãƒ©ã‚°ãŒç«‹ã£ã¦ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå‡ºã‚‹
              // resolveã—ãŸå ´åˆã¯è‡ªå‹•ã§é–‰ã˜ã¦ã€rejectã®å ´åˆã¯processingãƒ•ãƒ©ã‚°ã ã‘OFFã«ã—ã¦ãã®å ´ã«æ­¢ã¾ã‚‹
              return new Promise((resolve, reject) => {
                window.setTimeout(() => {
                  switch (asyncExecType) {
                    case "success":
                      resolve();
                      enqueueSnackbar("æˆåŠŸã—ã¾ã—ãŸï¼", {
                        variant: "success",
                      });
                      return;
                    case "fail":
                      reject();
                      enqueueSnackbar("å¤±æ•—ã—ã¾ã—ãŸã€‚ã€‚", {
                        variant: "error",
                      });
                      return;
                  }
                }, waitTime);
              });
            },
          });
        }}
      >
        ç¢ºèª
      </Button>
      {dialogElement}
    </Box>
  );
};
```

### ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã§ãƒ•ã‚©ãƒ¼ãƒ å…¥åŠ›ã«å¯¾å¿œã™ã‚‹

æœ€å¾Œã«ä»¥ä¸‹ã®ã‚ˆã†ãªæ–‡å­—ã‚’å…¥åŠ›ã—ã¦æœ€çµ‚ç¢ºèªã™ã‚‹ã‚ˆã†ãªç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’ã¤ã‘ã‚‹ã‚ˆã†ã«ã™ã‚‹ã“ã¨ã‚’è€ƒãˆã¾ã™ã€‚

![](/images/use-custom-confirm/confirm-with-form.png)

ã“ã‚Œã¯ã“ã‚Œä»¥ä¸Š`useCustomConfirm`ã‚’æ‹¡å¼µã™ã‚‹å¿…è¦ãŒãªãã€ãƒ©ãƒƒãƒ—ã—ãŸhooksã®æ–¹ã§èª¿æ•´ã™ã‚‹ã ã‘ã§å®Ÿç¾ã§ãã¾ã™ã€‚ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆã¯ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ã—ãªã„ã¨æŒã¦ãªã„ãŸã‚ãã‚Œå°‚ç”¨ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œã£ã¦`renderContent`ãƒ¡ã‚½ãƒƒãƒ‰ã§å‘¼ã³å‡ºã™ã‚ˆã†ã«ã—ã¾ã™ã€‚

```tsx:useCustomFormã‚’ä½¿ã£ã¦ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ã‚’ä»˜ã‘ã‚‹ä¾‹
const ConfirmForm: FC<{
  confirmText: string;
  processing: boolean;
  onOk: () => void;
  onCancel: () => void;
}> = ({ confirmText, processing, onOk, onCancel }) => {
  const [inputText, setInputText] = useState("");
  return (
    <>
      <DialogContent>
        <Box>
          ç¢ºèªã®ãŸã‚ã€Œ
          <Typography component="span" fontWeight="bold">
            {confirmText}
          </Typography>
          ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
        </Box>
        <TextField
          value={inputText}
          fullWidth
          size="small"
          onChange={(event) => {
            setInputText(event.target.value);
          }}
        />
      </DialogContent>
      <DialogActions>
        <LoadingButton
          loading={processing}
          variant="outlined"
          onClick={onCancel}
        >
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </LoadingButton>
        <LoadingButton
          loading={processing}
          variant="contained"
          color="error"
          disabled={inputText !== confirmText}
          onClick={onOk}
        >
          OK
        </LoadingButton>
      </DialogActions>
    </>
  );
};
const useCustomConfirmWithForm = () => {
  return useCustomConfirm<{ confirmText: string }>({
    renderContent: ({ props, processing, ok, cancel }) => {
      if (props == null) {
        return <></>;
      }
      return (
        <>
          <DialogTitle>ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ä»˜ããƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
          <ConfirmForm
            confirmText={props.confirmText}
            processing={processing}
            onOk={ok}
            onCancel={cancel}
          />
        </>
      );
    }
  });
};
```

```tsx:useCustomConfirmWithFormã®å‘¼ã³å‡ºã—ä¾‹
const Page: FC = () => {
  const { confirm, dialogElement } = useCustomConfirmWithForm();

  return (
    <Box>
      <Button
        variant="contained"
        color="error"
        onClick={() => {
          confirm({
            props: {
              confirmText: "confirm"
            },
            onOk: () => {
              return new Promise((resolve) => {
                window.setTimeout(() => {
                  resolve();
                  enqueueSnackbar("å®Ÿè¡Œã—ã¾ã—ãŸ", {
                    variant: "success"
                  });
                }, 1000);
              });
            }
          });
        }}
      >
        ç¢ºèª
      </Button>
      {dialogElement}
    </Box>
  );
};
```

## submitéƒ¨åˆ†ã‚‚æ‹¡å¼µã—ãŸuseCustomFormDialogã‚’ä½œã‚‹

ä»Šã¾ã§ã¯ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ã“ã¨ã ã‘ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å½“ã¦ã¦ä½œã£ã¦ã„ã¾ã—ãŸãŒã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã«ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å†…ã§å…¥åŠ›ã—ãŸå†…å®¹ã‚‚å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã‚‰æ›´ã«è‡ªç”±åº¦ã‚’ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ãªã¨æ€ã„ã€`useCustomFormDialog`ã‚‚ä½œã£ã¦ã¿ã¾ã—ãŸã€‚

```diff tsx:é€ä¿¡ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«æ›´ã«æ‹¡å¼µã™ã‚‹
 import { ReactElement, useState, useCallback } from "react";

 import { Dialog } from "@mui/material";

 /** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§è¿½åŠ ã™ã‚‹å‹ */
 type AdditionalContentProps<ContentProps = undefined> = [ContentProps] extends [
   undefined
 ]
   ? {}
   : {
       props: ContentProps;
     };

+/** é€ä¿¡ãƒ¡ã‚½ãƒƒãƒ‰ã®å‹ */
+type SubmitExecuter<SubmitData = undefined> = [SubmitData] extends [undefined]
+  ? () => void
+  : (submitData: SubmitData) => void;

 export type UseCustomFormDialogOption<
   ContentProps = undefined,
+  SubmitData = undefined
 > = {
   /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’æç”»ã™ã‚‹ */
   renderContent: (props: {
     /** ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã«æ¸¡ã™props */
     props?: ContentProps;
     /** å‡¦ç†ä¸­ã‹ */
     processing: boolean;
-    /** OKã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹ */
-    ok: () => void;
+    /** é€ä¿¡ã™ã‚‹ */
+    submit: SubmitExecuter<SubmitData>;
     /** ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ */
     cancel: () => void;
   }) => ReactElement;
 };

-/** ã‚¯ãƒªãƒƒã‚¯æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ */
-type ActionHandler = () => void | Promise<void>;
+/** é€ä¿¡æ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ */
+type SubmitHandler<SubmitData = undefined> = (
+  data: SubmitData
+) => void | Promise<void>;

 export type ReturnUseCustomFormDialog<
   ContentProps = undefined,
+  SubmitData = undefined
 > = {
-  /** ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‡ºã™ */
-  confirm: (
-    props: {
-      onOk: ActionHandler;
-    } & AdditionalContentProps<ContentProps>
-  ) => void;
+  /** ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤ºã™ã‚‹ */
+  open: (
+    props: {
+      onSubmit: SubmitHandler<SubmitData>;
+    } & AdditionalContentProps<ContentProps>
+  ) => void;
   /** ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹ */
   close: () => void;
   /** ãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¦ç´  */
   dialogElement: ReactElement;
 };

 export const useCustomFormDialog = function <
   ContentProps = undefined,
+  SubmitData = undefined
 >({
   renderContent
 }: UseCustomFormDialogOption<
   ContentProps,
+  SubmitData
 >): ReturnUseCustomFormDialog<ContentProps, SubmitData> {
   const [isProcessing, setIsProcessing] = useState(false);
-  const [execOk, setExecOk] = useState<ActionHandler | null>(null);
+  const [execSubmit, setExecSubmit] = useState<SubmitHandler<
    SubmitData
  > | null>(null);
   const [contentProps, setContentProps] = useState<ContentProps>();

   const handleSubmit = useCallback(
+    (data: SubmitData) => {
       if (execSubmit == null) {
         return;
       }
-      const result = execOk();
+      const result = execSubmit(data);
       if (!(result instanceof Promise)) {
         setExecSubmit(null);
         return;
       }

       setIsProcessing(true);
       result
         .then(() => {
           setExecSubmit(null);
         })
         .catch((err) => {
           console.log("catch reject", err);
         })
         .finally(() => {
           setIsProcessing(false);
         });
     },
     [execSubmit]
   );

   const handleClose = useCallback(() => {
     // å‡¦ç†ä¸­ã¯é–‰ã˜ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹
     if (isProcessing) {
       return;
     }
     setExecSubmit(null);
   }, [isProcessing]);

   const open: ReturnUseCustomFormDialog<
     ContentProps,
     SubmitData
   >["open"] = useCallback(({ onSubmit, ...restProps }) => {
     if ("props" in restProps) {
       setContentProps(restProps.props as ContentProps);
     }
     setExecSubmit(() => onSubmit);
   }, []);

   const dialogContentElement = renderContent({
     props: contentProps,
     processing: isProcessing,
-    ok: handleOk,
+    submit: handleSubmit as SubmitExecuter<SubmitData>,
     cancel: handleClose
   });

   const isOpen = execSubmit != null;
   const dialogElement: ReturnUseCustomFormDialog<
     ContentProps,
+    SubmitData
   >["dialogElement"] = (
     <Dialog open={isOpen} onClose={handleClose}>
       {dialogContentElement}
     </Dialog>
   );

   return {
     open,
     close: handleClose,
     dialogElement
   };
 };
```

ã“ã‚Œã‚’ä½¿ã†ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªã“ã¨ãŒã§ãã¾ã™ã€‚ä¾‹ã¯ã‚ªãƒã‚±ã¿ãŸã„ãªã‚‚ã®ãªã®ã§æœ€åˆã¯æŠ˜ã‚Šç•³ã‚“ã çŠ¶æ…‹ã§æ²è¼‰ã—ã¾ã™ã®ã§èˆˆå‘³ãŒã‚ã‚‹æ–¹ã¯é–‹ã„ã¦ã¿ã¦ãã ã•ã„ã€‚

:::details ä¾‹: ã‚·ãƒ³ãƒ—ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°

```tsx:ã‚·ãƒ³ãƒ—ãƒ«ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‘¼ã¶hooks
const SimpleCustomForm: FC<{
  onSubmit: (data: string) => void;
  onCancel: () => void;
}> = ({ onSubmit, onCancel }) => {
  const [text, setText] = useState("");
  return (
    <>
      <DialogContent>
        <TextField
          sx={{ mt: 1 }}
          value={text}
          label="ãƒ†ã‚­ã‚¹ãƒˆ"
          size="small"
          fullWidth
          onChange={(event) => {
            setText(event.target.value);
          }}
        />
      </DialogContent>
      <DialogActions>
        <Button variant="outlined" onClick={onCancel}>
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </Button>
        <Button
          variant="contained"
          disabled={text === ""}
          onClick={() => {
            onSubmit(text);
          }}
        >
          é€ä¿¡
        </Button>
      </DialogActions>
    </>
  );
};
const useSimpleCustomFormDialog = () => {
  return useCustomFormDialog<undefined, string>({
    renderContent: ({ submit, cancel }) => {
      return (
        <>
          <DialogTitle>ã‚·ãƒ³ãƒ—ãƒ«ã‚«ã‚¹ã‚¿ãƒ ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
          <SimpleCustomForm onSubmit={submit} onCancel={cancel} />
        </>
      );
    },
  });
};
```

```tsx:useSimpleCustomFormDialogã®å‘¼ã³å‡ºã—ä¾‹
const Page: FC = () => {
  const { open, dialogElement } = useSimpleCustomFormDialog();

  return (
    <Box>
      <Button
        variant="contained"
        onClick={() => {
          open({
            onSubmit: (data) => {
              enqueueSnackbar(`ã€Œ${data}ã€ã‚’é€ä¿¡ã—ã¾ã—ãŸ`, {
                variant: "success"
              });
            }
          });
        }}
      >
        é–‹ã
      </Button>
      {dialogElement}
    </Box>
  )
}
```

:::

:::details ä¾‹: éåŒæœŸè¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°

```tsx:éåŒæœŸè¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‘¼ã¶hooks
type AsyncExecType = "success" | "fail";
const AsyncSettingCustomForm: FC<{
  processing: boolean;
  onSubmit: (data: { asyncExecType: AsyncExecType; waitTime: number }) => void;
  onCancel: () => void;
}> = ({ processing, onSubmit, onCancel }) => {
  const [waitTime, setWaitTime] = useState(1000);
  const [asyncExecType, setAsyncExecType] = useState<AsyncExecType>("success");

  return (
    <>
      <DialogContent>
        <FormControl>
          <FormLabel>éåŒæœŸå®Ÿè¡Œç¨®åˆ¥</FormLabel>
          <RadioGroup
            value={asyncExecType}
            row
            onChange={(event) => {
              setAsyncExecType(event.target.value as AsyncExecType);
            }}
          >
            <FormControlLabel
              value="success"
              control={<Radio />}
              label="æˆåŠŸ"
            />
            <FormControlLabel value="fail" control={<Radio />} label="å¤±æ•—" />
          </RadioGroup>
        </FormControl>
        <br />
        <TextField
          sx={{ mt: 1 }}
          value={waitTime}
          label="é…å»¶æ™‚é–“"
          type="number"
          size="small"
          onChange={(event) => {
            const elInput = event.target;
            if (!(elInput instanceof HTMLInputElement)) {
              return;
            }

            setWaitTime(elInput.valueAsNumber);
          }}
        />
      </DialogContent>
      <DialogActions>
        <LoadingButton
          loading={processing}
          variant="outlined"
          onClick={onCancel}
        >
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </LoadingButton>
        <LoadingButton
          loading={processing}
          variant="contained"
          onClick={() => {
            onSubmit({
              asyncExecType,
              waitTime,
            });
          }}
        >
          é€ä¿¡
        </LoadingButton>
      </DialogActions>
    </>
  );
};
const useAsyncSettingCustomFormDialog = () => {
  return useCustomFormDialog<
    undefined,
    {
      asyncExecType: AsyncExecType;
      waitTime: number;
    }
  >({
    renderContent: ({ processing, submit, cancel }) => {
      return (
        <>
          <DialogTitle>éåŒæœŸè¨­å®šãƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
          <AsyncSettingCustomForm
            processing={processing}
            onSubmit={submit}
            onCancel={cancel}
          />
        </>
      );
    },
  });
};
```

```tsx:useAsyncSettingCustomFormDialogã®å‘¼ã³å‡ºã—ä¾‹
const Page: FC = () => {
  const { open, dialogElement } = useAsyncSettingCustomFormDialog();

  return (
    <Box>
      <Button
        variant="contained"
        onClick={() => {
          open({
            onSubmit: (data) => {
              return new Promise((resolve, reject) => {
                window.setTimeout(() => {
                  switch (data.asyncExecType) {
                    case "success":
                      resolve();
                      enqueueSnackbar("æˆåŠŸã—ã¾ã—ãŸ", {
                        variant: "success",
                      });
                      return;
                    case "fail":
                      reject();
                      enqueueSnackbar("å¤±æ•—ã—ã¾ã—ãŸã€‚ã€‚", {
                        variant: "error",
                      });
                      return;
                  }
                }, data.waitTime);
              });
            },
          });
        }}
      >
        é–‹ã
      </Button>
      {dialogElement}
    </Box>
  );
};
```

:::

:::details ä¾‹: ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°

```tsx:ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’å‘¼ã¶hooks
const ConfirmCustomForm: FC<{
  confirmText: string;
  processing: boolean;
  onSubmit: () => void;
  onCancel: () => void;
}> = ({ confirmText, processing, onSubmit, onCancel }) => {
  const [inputText, setInputText] = useState("");
  return (
    <>
      <DialogContent>
        <Box>
          ç¢ºèªã®ãŸã‚ã€Œ
          <Typography component="span" fontWeight="bold">
            {confirmText}
          </Typography>
          ã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚
        </Box>
        <TextField
          value={inputText}
          fullWidth
          size="small"
          onChange={(event) => {
            setInputText(event.target.value);
          }}
        />
      </DialogContent>
      <DialogActions>
        <LoadingButton
          loading={processing}
          variant="outlined"
          onClick={onCancel}
        >
          ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        </LoadingButton>
        <LoadingButton
          loading={processing}
          variant="contained"
          color="error"
          disabled={inputText !== confirmText}
          onClick={onSubmit}
        >
          é€ä¿¡
        </LoadingButton>
      </DialogActions>
    </>
  );
};
const useConfirmCustomFormDialog = () => {
  return useCustomFormDialog<{ confirmText: string }>({
    renderContent: ({ props, processing, submit, cancel }) => {
      if (props == null) {
        return <></>;
      }
      return (
        <>
          <DialogTitle>ç¢ºèªãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°</DialogTitle>
          <ConfirmCustomForm
            confirmText={props.confirmText}
            processing={processing}
            onSubmit={submit}
            onCancel={cancel}
          />
        </>
      );
    }
  });
};
```

```tsx:useConfirmCustomFormDialogã®å‘¼ã³å‡ºã—ä¾‹
const Page: FC = () => {
  const { open, dialogElement } = useConfirmCustomFormDialog();

  return (
    <Box>
      <Button
        variant="contained"
        color="error"
        onClick={() => {
          open({
            props: {
              confirmText: "confirm"
            },
            onSubmit: () => {
              return new Promise((resolve) => {
                window.setTimeout(() => {
                  resolve();
                  enqueueSnackbar("é€ä¿¡ã—ã¾ã—ãŸ", {
                    variant: "success"
                  });
                }, 1000);
              });
            }
          });
        }}
      >
        é–‹ã
      </Button>
      {dialogElement}
    </Box>
  )
}
```

:::

## æ¤œè¨¼ã‚³ãƒ¼ãƒ‰

ã“ã®è¨˜äº‹ã§ç´¹ä»‹ã—ãŸã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®CodeSandboxã«ã‚ã‚Šã¾ã™ã®ã§ã€å‹•ãã‚„è©³ç´°ã®ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ãŸã„æ–¹ã¯ã”è¦§ãã ã•ã„ã€‚

@[codesandbox](https://codesandbox.io/embed/uinokasutamaizugake-neng-nazi-zuo-usecustomconfirmwozuo-ru-28zl8q?fontsize=14&hidenavigation=1&theme=dark)

## çµ‚ã‚ã‚Šã«

ä»¥ä¸ŠãŒã‚«ã‚¹ã‚¿ãƒ ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’React hooksã§å®Ÿè£…ã™ã‚‹æ–¹æ³•ã§ã—ãŸã€‚ã‚«ã‚¹ã‚¿ãƒ UIéƒ¨åˆ†ã‚‚hookså´ã«é–‰ã˜è¾¼ã‚ã¦å‘¼ã³å‡ºã™ã ã‘ã§OKæ™‚ã®å‡¦ç†ã‚’è¨­å®šã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ãŒç›¸å½“ã‚¹ãƒƒã‚­ãƒªã™ã‚‹ã¨æ€ã„ã¾ã—ãŸã€‚æ›´ã«ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãŒè‰²ã€…ãªç”»é¢ã§ä½¿ã‚ã‚Œã‚‹å ´åˆã¯å…±é€šã®ã‚‚ã®ã‚’ä½¿ã„ã‚„ã™ããªã£ãŸã¨æ€ã„ã¾ã—ãŸã€‚
ç¢ºèªãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã ã‘ã§ã¯ãªãã€æ›´ã«æ‹¡å¼µã™ã‚‹ã“ã¨ã§ãƒ•ã‚©ãƒ¼ãƒ ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã«ã¤ã„ã¦ã‚‚hookså´ã«åˆ‡ã‚Šå‡ºã™ã“ã¨ãŒã§ãã€ç›¸å½“æ±ç”¨æ€§ãŒé«˜ããªã£ãŸãªã¨æ„Ÿã˜ã¾ã—ãŸã€‚ãŸã ãã®åˆ†`useCustomFormDialog`ãŒè¤‡é›‘ã«ãªã‚Šã™ãã¦åˆè¦‹ã ã¨è©³ç´°ã®æµã‚ŒãŒç†è§£ã—ã¥ã‚‰ã‹ã£ãŸã‚Šã€ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯æ™‚ã®ãƒ­ã‚¸ãƒƒã‚¯ãŒé•·ããªã‚Šã™ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§çŠ¶æ³ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã¦ã„ã‘ã‚‹ã¨è‰¯ã„ã‹ãªã¨æ€ã„ã¾ã—ãŸã€‚
