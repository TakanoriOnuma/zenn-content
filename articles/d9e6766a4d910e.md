---
title: "ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’TypeScriptã§ä½œã‚‹éš›ã«v8ã¨v9ã®å·®ã‚’æ¤œè¨¼ã—ã¦ã¿ãŸ"
emoji: "ğŸ•Œ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["eslint", "typescript"]
published: true
---

## å§‹ã‚ã«

ä»Šã¾ã§ESLintã®ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’TypeScriptã§ä½œã£ã¦äº‹å‰ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã€[eslint-plugin-local-rules](https://www.npmjs.com/package/eslint-plugin-local-rules)ã«æµã—è¾¼ã‚“ã§é‹ç”¨ã—ã¦ã¾ã—ãŸã€‚
å°è¦æ¨¡ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã‚ã‚Œã°ä¸€ç·’ã«ç½®ãã®ã¯ä½•ã‚‚å•é¡Œãªã„ã¨æ€ã„ã¾ã™ãŒã€ã‚³ãƒ¼ãƒ‰ãŒå¢—ãˆã‚‹ã¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦åˆ‡ã‚Šå‡ºã›ã‚‹ã‚‚ã®ã¯åˆ‡ã‚Šå‡ºã—ãŸã„æ°—æŒã¡ãŒé«˜ã¾ã£ã¦ãã¾ã—ãŸã€‚[eslint-plugin-react-hooks](https://www.npmjs.com/package/eslint-plugin-react-hooks)ã®ã‚ˆã†ã«ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åŒ–ã™ã‚‹ã¨ãã£ã¡ã®ãƒªãƒã‚¸ãƒˆãƒªã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚„ãƒ†ã‚¹ãƒˆãŒã§ãã‚‹ã®ã§ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å´ã®ãƒªãƒã‚¸ãƒˆãƒªã¯ãã“ã ã‘ã«é›†ä¸­ã§ãã¦è‰¯ã„ã§ã™ã‚ˆã­ã€‚

ãŸã æœ€è¿‘ã¯ESLint v9ãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦Flat Configã§å¤§å¹…ã«å¤‰ã‚ã£ã¦ã—ã¾ã†ãŸã‚v9ç”¨ã§ä½œã‚ã†ã‹ãªã¨æ€ã„ã¾ã—ãŸãŒã€æ®‹å¿µãªãŒã‚‰Next.jsã®ESLintãƒ«ãƒ¼ãƒ«ãŒæ¬¡ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚ã‚‹`eslint-config-next@15`ã§ã‚ã£ã¦ã‚‚v9ã¯æŒ‡å®šã•ã‚Œã¦ãŠã‚‰ãšv9ç³»ã‚µãƒãƒ¼ãƒˆã«æ™‚é–“ãŒã‹ã‹ã‚Šãã†ãªé›°å›²æ°—ã§ã€ã¾ã v8ã§å‹•ã‹ã—ã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãªã¨æ„Ÿã˜ã¾ã—ãŸã€‚

https://github.com/vercel/next.js/blob/v15.0.0-canary.160/packages/eslint-config-next/package.json#L25

> çµè«–ã€ä»Šã¯ã¾ã  Next.js ã§ flat config ã‚’ä½¿ã†ã®ã¯å¾…ã£ãŸã»ã†ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚ï¼ˆNext.js ã®å¯¾å¿œã‚’å¾…ã¡ã¾ã—ã‚‡ã†ï¼‰

https://zenn.dev/hsato_workman/articles/0f10b04a25963c

v9ã«å®Œå…¨ã«ç§»è¡Œã™ã‚‹ã¾ã§ã¯å¾…ã¤ã¹ãã‹æ‚©ã‚“ã§ã„ã¾ã—ãŸãŒã€ãã‚‚ãã‚‚ä»Šå›ã®v8ã‹ã‚‰v9ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚¢ãƒƒãƒ—ã§ã¯configã®æ¸¡ã—æ–¹ãŒå¤§å¹…ã«å¤‰ã‚ã£ãŸã ã‘ã§ãƒ«ãƒ¼ãƒ«ã®ä½œã‚Šæ–¹è‡ªä½“ã¯ãã“ã¾ã§å¤‰ã‚ã‚‰ãªã„ã®ã§ã¯ï¼Ÿã¨æ€ã£ãŸã®ã§è©¦ã—ã«v8ã¨v9ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œã£ã¦ã¿ã¦ã€ã©ã†ã„ã†å¤‰æ›´ãŒå¿…è¦ã«ãªã‚‹ã‹ç¢ºèªã—ã¦ã¿ã¾ã—ãŸã€‚

### çµè«–

å…ˆã«çµè«–ã‚’è¨€ã†ã¨ã€ç°¡å˜ãªãƒ«ãƒ¼ãƒ«ã§ã‚ã‚Œã°å…¨ãä½œã‚ŠãŒä¸€ç·’ã ã£ãŸã®ã§v8ã¨ã—ã¦ä½œã£ã¦ã„ã¦ã‚‚v9ã§ã‚‚å¼•ãç¶šãå•é¡Œãªãä½¿ãˆãã†ã§ã—ãŸã€‚ãŸã v9ã«ãªã‚‹ã¨pluginã®è¨­å®šã¯ç›´æ¥ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã§ãã¦`eslint-plugin-local-rules`ã‚’çµŒç”±ã™ã‚‹å¿…è¦ãŒãªããªã£ãŸã‚Šã€TypeScriptã§è¨­å®šã‚’æ›¸ãã“ã¨ã‚‚ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šãã†ã§ã‚ã‚“ã¾ã‚Šãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦åˆ‡ã‚Šå‡ºã™æ—¨ã¿ãŒå°‘ãªããªã‚Šãã†ã ãªã¨æ€ã„ã¾ã—ãŸã€‚

https://blog.sa2taka.com/post/custom-eslint-rule-with-flat-config/

https://github.com/microsoft/vscode-eslint/issues/1917

### ä½œã£ãŸã‚‚ã®

ä»Šå›ä½œã£ãŸãƒ«ãƒ¼ãƒ«ã¯iconã‚’importã™ã‚‹éš›ã«`~Icon`ã¨ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã‚‚ã®ã§ã™ã€‚

```ts:~Iconã«ã™ã‚‹ãƒ«ãƒ¼ãƒ«
// OK
import { AccessAlarm as AccessAlarmIcon } from '@mui/icons-material'

// NG
import { AccessAlarm } from '@mui/icons-material'
import AccessAlarm from '@mui/icons-material/AccessAlarm' // æ¤œè¨¼ãŒæ‰‹é–“ã ã£ãŸã®ã§NamedImportã®ã¿ã«åˆ¶é™ã™ã‚‹
```

v9ã®ESLintã§ã¯v8ã¨v9ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã©ã¡ã‚‰ã‚‚ä½¿ãˆã¾ã—ãŸã®ã§ãã‚Œãã‚Œã®ã‚¨ãƒ©ãƒ¼ãŒVSCodeã§å‡ºã¦ã„ã¾ã™ã€‚

![](/images/eslint-custom-plugin-v8-and-v9/validate-suffix-icon-import.png)

ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã¯ã€ä»Šå›ã¯ç°¡æ˜“æ¤œè¨¼ãªã®ã§npm workspaceã‚’ä½¿ã£ã¦ãƒ¢ãƒãƒ¬ãƒã§v8ã¨v9ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ãã‚Œãã‚Œä½œã£ã¦ã€ãã‚Œã‚‰ã‚’importã—ã¦ä½¿ã„ã¾ã—ãŸã€‚å®Ÿé‹ç”¨ã§ã¯`eslint-plugin-local-v8`ãªã©ãŒãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦publishã—ã¦ãã‚Œã‚’installã—ã¦ä½¿ã†ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã€‚

```:ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
.
â”œâ”€â”€ README.md
â”œâ”€â”€ eslint-plugins (ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç¾¤)
â”‚   â”œâ”€â”€ eslint-plugin-local-v8ï¼ˆv8ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼‰
â”‚   â””â”€â”€ eslint-plugin-local-v9ï¼ˆv9ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼‰
â”œâ”€â”€ eslint.config.jsï¼ˆv9ã®ESLintè¨­å®šï¼‰
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â”œâ”€â”€ srcï¼ˆReactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰
â”œâ”€â”€ tsconfig.app.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsconfig.node.json
â””â”€â”€ vite.config.ts
```

https://github.com/TakanoriOnuma/trial-eslint-custom-plugin

v8ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ãã‚‚ãã‚‚ESLint v8ã®æ™‚ã«ä½¿ãˆã‚‹ã‚‚ã®ã‹ç¢ºèªã™ã‚‹ãŸã‚ã€ãƒ–ãƒ©ãƒ³ãƒã‚’åˆ‡ã£ã¦v8ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚³ãƒ¼ãƒ‰ã‚‚è©¦ã—ã¾ã—ãŸã€‚ä¸Šè¨˜ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆã®`eslint.config.js`ãŒ`eslintrc.cjs`ã«å¤‰ã‚ã‚Šã¾ã™ã€‚

https://github.com/TakanoriOnuma/trial-eslint-custom-plugin/tree/eslint-v8_2

:::message
ã¾ã ç†è§£ãŒæµ…ã„ã¨ã“ã‚ãŒã‚ã‚‹ãŸã‚ã¨ã‚Šã‚ãˆãšå‹•ãã“ã¨ã¯ç¢ºèªã—ã¾ã—ãŸãŒã€æœ¬å½“ã¯è‰¯ããªã„æ›¸ãæ–¹ã‚’ã—ã¦ã„ã‚‹ç®‡æ‰€ãŒã‚ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã®ã§ã€ãã“ã¯ã”äº†æ‰¿ãã ã•ã„ã€‚
:::

## ESLint v8ã®å ´åˆ

### v8ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®åŸºæœ¬æ§‹æˆ

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆã¯å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¨`eslint-plugin-react-hooks`ã®ã‚³ãƒ¼ãƒ‰ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚
https://eslint.org/docs/v8.x/extend/plugins

https://github.com/facebook/react/blob/v18.3.1/packages/eslint-plugin-react-hooks/src/index.js#L1-L26

ã“ã‚Œã‚‰ã‚’å‚è€ƒã«ã€TypeScriptã§æ›¸ãã¨ä»¥ä¸‹ã®ã‚ˆã†ãªæ§‹æˆã§æ›¸ãã¨è‰¯ã•ãã†ã§ã—ãŸã€‚

```ts:TypeScriptã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½œã‚‹éš›ã®åŸºæœ¬æ§‹æˆ
import type { ESLint } from "eslint";

// ruleã‚’import
import { customRule } from "./rules/customRule";

const plugin = {
  configs: {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä¸€æ‹¬è¨­å®šã™ã‚‹ãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆeslint:recommendedçš„ãªã‚„ã¤ï¼‰
    // recommendedãŒä¸è¦ãªå ´åˆã¯æœªå®šç¾©ã§ã‚‚è‰¯ã„
    recommended: {
      // recommendedå†…ã§è‡ªåˆ†ã®pluginsã‚’è¨­å®šã™ã‚‹ã¨è‡ªå‹•ã§ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ç™»éŒ²ã‚‚ã‚„ã£ã¦ãã‚Œã‚‹(v8ã®ã¿ã€‚v9ã‹ã‚‰pluginsã®è¨­å®šã¯ãŠãã‚‰ãéæ¨å¥¨)
      plugins: ["<ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å>"],
      rules: {
        "<ãƒ—ãƒ©ã‚°ã‚¤ãƒ³å>/custom-rule": "warn",
      },
    },
  },
  // ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã‚’å®šç¾©
  rules: {
    "custom-rule": customRule,
  },
} satisfies ESLint.Plugin;

export = plugin;
```

### v8ã§ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆ

ä»Šå›ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸åã¯ `@local/eslint-plugin-local-v8` ã¨ã„ã†åå‰ã«ã—ã€package.jsonã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```json:eslint-plugin-local-v8/package.json
{
  "name": "@local/eslint-plugin-local-v8",
  "private": true,
  "version": "0.0.0",
  "main": "dist/index.js",
  "exports": {
    ".": {
      "import": "./dist/index.js",
      "require": "./dist/index.js"
    }
  },
  "scripts": {
    "build": "tsc",
    "test": "vitest run"
  },
  "devDependencies": {
    "@types/eslint": "8.40.2",
    "@types/node": "^22.5.5",
    "eslint": "8.43.0",
    "typescript": "5.3.3",
    "vitest": "^2.1.1"
  },
  "peerDependencies": {
    "eslint": ">=8"
  }
}
```

ESLintã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ä½œæˆã¯ä»–ã§ã‚‚è¨˜äº‹ãŒã‚ã‚Šã¾ã—ãŸã®ã§ã€ãã¡ã‚‰ã«è­²ã‚Šã¾ã™ã€‚
https://blog.sa2taka.com/post/custom-eslint-rule-with-typescript/

æœ€çµ‚çš„ã«å‡ºæ¥ä¸ŠãŒã£ãŸãƒ«ãƒ¼ãƒ«ã¯ä»¥ä¸‹ã§ã™ã€‚

```ts:suffix-icon-import.ts
import type { Rule } from "eslint";

export const suffixIconImport: Rule.RuleModule = {
  meta: {
    type: "problem",
    fixable: "code",
  },
  create(context) {
    return {
      ImportDeclaration: (node) => {
        const importLabel = node.source.value;
        if (typeof importLabel !== "string") {
          return;
        }

        const expectImportLabel = "@mui/icons-material";
        if (!importLabel.startsWith(expectImportLabel)) {
          return;
        }
        // @mui/icons-material/AccessAlarmIcon ã¿ãŸã„ãªimportã‚’ã—ã¦ã„ã‚‹å ´åˆ
        if (importLabel !== expectImportLabel) {
          context.report({
            node,
            message: `ãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®šã«ã‚ˆã‚‹importã¯ç¦æ­¢ã—ã¦ã„ã¾ã™ã€‚'@mui/icons-material'ã‹ã‚‰importã—ã¦ãã ã•ã„ã€‚`,
          });
          return;
        }

        for (const specifier of node.specifiers) {
          if (specifier.type !== "ImportSpecifier") {
            continue;
          }
          const localName = specifier.local.name;
          const importedName = specifier.imported.name;
          const expectedLocalName = `${importedName}Icon`;
          if (localName !== expectedLocalName && specifier.loc != null) {
            context.report({
              loc: specifier.loc,
              message: "~Iconã¨ã„ã†åå‰ã§ä½¿ç”¨ã—ã¦ãã ã•ã„",
              fix(fixer) {
                return fixer.replaceText(
                  specifier,
                  `${importedName} as ${expectedLocalName}`
                );
              },
            });
          }
        }
      },
    };
  },
};
```

ã“ã‚Œã‚’ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦æ•´ç†ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

```ts:v8ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³(./lib/index.ts)
import type { ESLint } from "eslint";

import { suffixIconImport } from "./rules/suffix-icon-import";

const plugin = {
  configs: {
    recommended: {
      plugins: ["@local/local-v8"],
      rules: {
        "@local/local-v8/suffix-icon-import": "warn",
      },
    },
  },
  rules: {
    "suffix-icon-import": suffixIconImport,
  },
} satisfies ESLint.Plugin;

export = plugin;
```

ã“ã‚Œã‚’ä»¥ä¸‹ã®ã‚ˆã†ãªtsconfig.jsonã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ãŸã‚‰å®Œæˆã§ã™ã€‚ãƒ‡ãƒãƒƒã‚°ã§sourceMapã¨ã‹ç„¡é§„ãªã‚‚ã®ã‚’å‡ºåŠ›ã—ã¦ã„ã¾ã™ãŒã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã—ã¦publishã™ã‚‹éš›ã¯falseã«ã—ã¦ã„ãŸæ–¹ãŒè‰¯ã„ã¨æ€ã„ã¾ã™ã€‚

```json:tsconfig.json
{
  "compilerOptions": {
    "target": "ESNext",
    "module": "CommonJS",
    "outDir": "./dist",
    "esModuleInterop": true,
    "sourceMap": true,
    "declaration": true,
    "declarationMap": true,
    "strict": true,
    "skipLibCheck": true
  },
  "include": ["./lib/index.ts"]
}
```

### v8ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å®Ÿéš›ã«ä½¿ã†

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³é©ç”¨ã®éš›ã¯`eslint-plugin-`ã‚’omitã—ã¦è¨­å®šã§ãã‚‹ãŸã‚ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãã“ã¨ã§è¨­å®šã§ãã¾ã™ã€‚recommendedã®ä¸­ã«pluginsã®è¨­å®šã‚‚ã‚ã‚‹ã®ã§ã€extendsã™ã‚‹ã ã‘ã§ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

https://eslint.org/docs/v8.x/use/configure/plugins

```diff ts:.eslintrc.cjsã«ä½œæˆã—ãŸãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ ã™ã‚‹
 module.exports = {
   root: true,
   env: { browser: true, es2020: true },
   extends: [
     "eslint:recommended",
     "plugin:@typescript-eslint/recommended",
     "plugin:react-hooks/recommended",
+    "plugin:@local/local-v8/recommended",
   ],
   ignorePatterns: ["dist", ".eslintrc.cjs"],
   parser: "@typescript-eslint/parser",
   plugins: ["react-refresh"],
   rules: {
     "react-refresh/only-export-components": [
       "warn",
       { allowConstantExport: true },
     ],
+    // ä¸Šæ›¸ããƒ«ãƒ¼ãƒ«è¨­å®š
+    "@local/local-v8/suffix-icon-import": "error",
   },
 };
```

### v8ã®ESLintã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆ

ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã¯ä»¥ä¸‹ã®è¨˜äº‹ã‚’å‚è€ƒã«Vitestã®è¨­å®šã‚’ã—ã¦ã€æ¬¡ã®ã‚ˆã†ãªãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã—ãŸã€‚

https://zenn.dev/s_takashi/articles/ee7eae7ba80b62#vitest%E3%81%AE%E8%BF%BD%E5%8A%A0

```ts:test/suffix-icon-import.test.ts
import { RuleTester } from "eslint";

import { suffixIconImport } from "../lib/rules/suffix-icon-import";

const ruleTester = new RuleTester({
  parser: require.resolve("@typescript-eslint/parser"),
});

ruleTester.run("suffix-icon-import", suffixIconImport, {
  valid: [
    {
      code: "import { AccessAlarm as AccessAlarmIcon } from '@mui/icons-material'",
    },
  ],
  invalid: [
    {
      code: "import AccessAlarm from '@mui/icons-material/AccessAlarm'",
      errors: [
        {
          message:
            "ãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®šã«ã‚ˆã‚‹importã¯ç¦æ­¢ã—ã¦ã„ã¾ã™ã€‚'@mui/icons-material'ã‹ã‚‰importã—ã¦ãã ã•ã„ã€‚",
        },
      ],
    },
    {
      code: "import { AccessAlarm } from '@mui/icons-material'",
      errors: [
        {
          message: "~Iconã¨ã„ã†åå‰ã§ä½¿ç”¨ã—ã¦ãã ã•ã„",
        },
      ],
      output:
        "import { AccessAlarm as AccessAlarmIcon } from '@mui/icons-material'",
    },
  ],
});
```

## ESLint v9ã®å ´åˆ

### v9ã§ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®ä½œæˆ

v9ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ä¸Šã’ã¦ä»¥ä¸‹ã®ã‚ˆã†ãªpackage.jsonã«ãªã‚Šã¾ã—ãŸã€‚

```diff json:eslint-plugin-local-v9/package.json
 {
-  "name": "@local/eslint-plugin-local-v8",
+  "name": "@local/eslint-plugin-local-v9",
   "private": true,
   "version": "0.0.0",
   "main": "dist/index.js",
   "exports": {
     ".": {
       "import": "./dist/index.js",
       "require": "./dist/index.js"
     }
   },
   "scripts": {
     "build": "tsc",
     "test": "vitest run"
   },
   "devDependencies": {
-    "@types/eslint": "8.40.2",
-    "@types/node": "^22.5.5",
-    "eslint": "8.43.0",
-    "typescript": "5.3.3",
+    "@types/eslint": "^9.6.1",
+    "eslint": "^9.9.0",
+    "typescript": "5.5.3",
     "vitest": "^2.1.1"
   },
   "peerDependencies": {
-    "eslint": ">=8"
+    "eslint": ">=9"
   },
 }
```

ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã®åŸºæœ¬æ§‹æˆã¯ã»ã¨ã‚“ã©å¤‰ã‚ã‚Šãªãã€pluginsã®è¨­å®šã®ã¿ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ãŠã„ãŸæ–¹ãŒè‰¯ã•ãã†ã§ã—ãŸã€‚ã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã«ã¤ã„ã¦ã¯v8ã¨å…¨ãåŒã˜ã‚³ãƒ¼ãƒ‰ã§å•é¡Œãªã‹ã£ãŸã®ã§å‰²æ„›ã—ã¾ã™ã€‚

```diff ts:v9ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³(./lib/index.ts)
 import type { ESLint } from "eslint";

 import { suffixIconImport } from "./rules/suffix-icon-import";

 const plugin = {
   configs: {
     recommended: {
-      plugins: ["@local/local-v8"],
+      // pluginsã¯å€‹åˆ¥ã§è¨­å®šã™ã‚‹ãŸã‚ã€ã“ã“ã§ã¯è¨­å®šã—ãªã„
+      // plugins: ["@local/local-v9"],
       rules: {
-        "@local/local-v8/suffix-icon-import": "warn",
+        "@local/local-v9/suffix-icon-import": "warn",
       },
     },
   },
   rules: {
     "suffix-icon-import": suffixIconImport,
   },
 } satisfies ESLint.Plugin;

 export = plugin;
```

### v9ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å®Ÿéš›ã«ä½¿ã†

v9ã‹ã‚‰ã¯`eslint.config.js`ã¨è¨€ã†åå‰ã«å¤‰ã‚ã‚Šã€ã‹ã¤FlatConfigã§è¨­å®šã™ã‚‹ãŸã‚ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’importã—ã¦è¨­å®šã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚recommendedã®rulesã¯ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰æ¼”ç®—ã§å±•é–‹ã—ã¦ä½¿ç”¨ã™ã‚‹ãŸã‚ã€ãƒ«ãƒ¼ãƒ«ã‚’ä¸Šæ›¸ãã—ã¦ã„ã‚‹ã®ãŒã‚ˆã‚Šåˆ†ã‹ã‚Šã‚„ã™ããªã£ãŸã¨æ€ã„ã¾ã—ãŸã€‚ãŸã pluginsã«è¨­å®šã™ã‚‹åå‰ã«ã¯æ°—ã‚’ã¤ã‘ã‚‹å¿…è¦ãŒã‚ã£ã¦ã€ä»Šå›ã®ã‚±ãƒ¼ã‚¹ã ã¨`@local/local-v9`ã¨è¨€ã†åå‰ã§pluginã‚’ç™»éŒ²ã—ãªã„ã¨recommendedã§ç”¨æ„ã—ãŸãƒ«ãƒ¼ãƒ«ã¨ãšã‚Œã¦ã—ã¾ã†ã®ãŒã¾ã æš—é»™çš„ãªã¨ã“ã‚ãŒã‚ã‚‹ãªãã¨æ€ã„ã¾ã—ãŸã€‚ã“ã“ã‚‚å°†æ¥çš„ã«ã¯å¤‰æ›´ãŒå…¥ã‚Šãã†ãªæ°—ãŒã—ã¾ã—ãŸã€‚

```diff js:eslint.config.js
 import js from "@eslint/js";
 import globals from "globals";
 import reactHooks from "eslint-plugin-react-hooks";
 import reactRefresh from "eslint-plugin-react-refresh";
 import tseslint from "typescript-eslint";
+import localV9 from "@local/eslint-plugin-local-v9";

 export default tseslint.config(
   { ignores: ["dist"] },
   {
     extends: [
       js.configs.recommended,
       ...tseslint.configs.recommended,
     ],
     files: ["**/*.{ts,tsx}"],
     languageOptions: {
       ecmaVersion: 2020,
       globals: globals.browser,
     },
     plugins: {
       "react-hooks": reactHooks,
       "react-refresh": reactRefresh,
+      "@local/local-v9": localV9,
     },
     rules: {
       ...reactHooks.configs.recommended.rules,
+      ...localV9.configs.recommended.rules,
       "react-refresh/only-export-components": [
         "warn",
         { allowConstantExport: true },
       ],
+      // ä¸Šæ›¸ããƒ«ãƒ¼ãƒ«è¨­å®š
+      "@local/local-v9/suffix-icon-import": "error",
     },
   }
 );
```

### v8ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹

å˜ç´”ã«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’importã—ã¦é©åˆ‡ãªå ´æ‰€ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã ã‘ãªã®ã§ã€v8ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚‚åŸºæœ¬çš„ã«ã¯å•é¡Œãªãä½¿ãˆã¾ã™ã€‚v9ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨åŒã˜æ–¹æ³•ã§ã‚‚ç™»éŒ²ã§ãã¾ã™ãŒã€extendsã®æ–¹ã§ç™»éŒ²ã™ã‚‹ã“ã¨ã‚‚å¼•ãç¶šãã§ããŸã®ã§ãã®æ–¹æ³•ã‚’è©¦ã—ã¦ã¿ã¾ã—ãŸã€‚ãŸã ã—pluginsã®è¨­å®šãŒé…åˆ—ã‹ã‚‰key-valueå½¢å¼ã«å¤‰ã‚ã£ã¦ã—ã¾ã£ãŸã®ã§ãã“ã¯æ›¸ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚ã“ã‚“ãªæ„Ÿã˜ã§extendsã§ã‚‚å¼•ãç¶šãè¨­å®šã§ãã¾ã™ãŒã€ãã‚‚ãã‚‚FlatConfigã®ã‚³ãƒ³ã‚»ãƒ—ãƒˆãŒæš—é»™çš„ãªç™»éŒ²ã‚’ã‚„ã‚ã¦æ˜ç¤ºçš„ã«æ›¸ã„ã¦ã„ãã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã‚‹ã¯ãšãªã®ã§åŸºæœ¬çš„ã«ã¯extendsã¯ä½¿ã‚ãªã„é‹ç”¨ãŒå¥½ã¾ã—ã„ã¨æ€ã„ã¾ã—ãŸã€‚

```diff ts:v8ã®ESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹
 import js from "@eslint/js";
 import globals from "globals";
 import reactHooks from "eslint-plugin-react-hooks";
 import reactRefresh from "eslint-plugin-react-refresh";
 import tseslint from "typescript-eslint";
+import localV8 from "@local/eslint-plugin-local-v8";
 import localV9 from "@local/eslint-plugin-local-v9";

 export default tseslint.config(
   { ignores: ["dist"] },
   {
     extends: [
       js.configs.recommended,
       ...tseslint.configs.recommended,
+      {
+        ...localV8.configs.recommended,
+        // pluginsã®è¨­å®šãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼ã«å¤‰ã‚ã£ãŸã®ã§ã€pluginsã®è¨­å®šã‚’ä¸Šæ›¸ã
+        plugins: {
+          "@local/local-v8": localV8,
+        },
+      },
     ],
     files: ["**/*.{ts,tsx}"],
     languageOptions: {
       ecmaVersion: 2020,
       globals: globals.browser,
     },
     plugins: {
       "react-hooks": reactHooks,
       "react-refresh": reactRefresh,
       "@local/local-v9": localV9,
     },
     rules: {
       ...reactHooks.configs.recommended.rules,
       ...localV9.configs.recommended.rules,
       "react-refresh/only-export-components": [
         "warn",
         { allowConstantExport: true },
       ],
       // ä¸Šæ›¸ããƒ«ãƒ¼ãƒ«è¨­å®š
+      "@local/local-v8/suffix-icon-import": "error",
       "@local/local-v9/suffix-icon-import": "error",
     },
   }
 );
```

### v9ã®ESLintã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆ

v9ã®ESLintã‚«ã‚¹ã‚¿ãƒ ãƒ«ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆã¯å†…å®¹è‡ªä½“ã¯å…¨ãåŒã˜ã§æ¸ˆã¿ã¾ã—ãŸãŒã€`RuleTester`ã«æ¸¡ã™parserãŒå¤‰ã‚ã‚Šã¾ã—ãŸã€‚`languageOptions.parser`ã®æ–¹ã«ç§»å‹•ã—ã¦ã€ã‹ã¤importå…ˆã®pathã§ã¯ãªãå®Ÿéš›ã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æ¸¡ã™å¿…è¦ã«ãªã£ãŸã®ã§ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¾ã—ãŸã€‚ãŸã RuleTesterã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãŒTypeScriptã«å¯¾å¿œã—ã¦ã„ã‚‹ã®ã‹ä¸æ˜ã§ã™ãŒã€parserã‚’è¨­å®šã—ãªãã¦ã‚‚ä»Šå›ã®ãƒ†ã‚¹ãƒˆã¯passã§ãã¾ã—ãŸã€‚

```diff ts:test/suffix-icon-import.test.ts
 import { RuleTester } from "eslint";
+import tsParser from "@typescript-eslint/parser";

 import { suffixIconImport } from "../lib/rules/suffix-icon-import";

 const ruleTester = new RuleTester({
-  parser: require.resolve("@typescript-eslint/parser"),
+  // ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¦ã‚‚å‹•ããã†ï¼Ÿ
+  languageOptions: {
+    parser: tsParser,
+  },
 });

 // ãƒ†ã‚¹ãƒˆã®ä¸­èº«ã¯å…¨ãåŒã˜ã§æ¸ˆã‚“ã ã®ã§çœç•¥
```

`languageOptions.parser`ã«è¨­å®šã™ã‚‹ä»¶ã¯ã“ã¡ã‚‰ã§ã¿ã¾ã—ãŸã€‚

https://github.com/angular-eslint/angular-eslint/issues/1966#issuecomment-2310749913

## ãã®ä»–

### VSCodeã®ã‚¨ãƒ‡ã‚£ã‚¿è¨­å®šã«ã¤ã„ã¦

ESLint v9ãŒãƒªãƒªãƒ¼ã‚¹ç›´å¾Œã®é ƒã¯VSCodeã§ã¯`eslint.experimental.useFlatConfig`ã‚’è¨­å®šã—ãªã„ã¨ã„ã‘ãªã‹ã£ãŸã®ã§ã™ãŒã€ä»Šã§ã¯ä¸è¦ã«ãªã£ãŸã‚ˆã†ã§ã™ã€‚ESLint v8ç³»ã§v8.57.0ä»¥ä¸Šã§FlatConfigã«ã—ã¦ã„ã‚‹å ´åˆã¯`eslint.useFlatConfig`ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

https://zenn.dev/gangannikki/articles/12bdae5236c846

## çµ‚ã‚ã‚Šã«

ä»¥ä¸ŠãŒESLintãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’TypeScriptã§ä½œã‚‹éš›ã«ç”Ÿã˜ã‚‹v8ã¨v9ã®å·®ã§ã—ãŸã€‚ç°¡å˜ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã ã¨å¤‰æ›´ãŒã»ã¼ãªã„ã“ã¨ãŒåˆ†ã‹ã‚Šã€ã¨ã‚Šã‚ãˆãšv8ã‹ã‚‰ä½œã£ã¦ã‚‚å•é¡Œãªã•ãã†ã¨ã„ã†ã“ã¨ãŒåˆ†ã‹ã£ã¦å®‰å¿ƒã—ã¾ã—ãŸã€‚ã¾ãŸä»Šã¾ã§extendsã‚„pluginã®è¨­å®šãŒã©ã†ã„ã†ãµã†ã«ã•ã‚Œã¦ã„ã‚‹ã‹åˆ†ã‹ã‚‰ãšã¨ã‚Šã‚ãˆãšãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®é€šã‚Šã«æ›¸ã„ã¦ã„ã¾ã—ãŸãŒã€ãã®è¾ºã®å‹•ãã‚‚ç†è§£ã§ãã¦è‰¯ã‹ã£ãŸãªã¨æ€ã„ã¾ã—ãŸã€‚ç‰¹ã«extendsã®ä¸­ã«pluginã®ç™»éŒ²ã‚‚å…¥ã£ã¦ã„ãŸã®ã¯é©šãã§ã€ã ã‹ã‚‰extendsã ã‘äº‹è¶³ã‚Šã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨pluginsã®æ–¹ã§è¨­å®šã—ãªã„ã¨ã„ã‘ãªã„ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã£ãŸã‚“ã ãªã¨ç†è§£ã§ãã¾ã—ãŸã€‚
ã“ã®è¨˜äº‹ãŒESLint Pluginã‚’è‡ªä½œã—ãŸã„æ–¹ã®å‚è€ƒã«ãªã‚ŒãŸã‚‰å¹¸ã„ã§ã™ã€‚
